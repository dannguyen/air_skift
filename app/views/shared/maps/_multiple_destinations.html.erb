<% 
	map_id ||= "route-destinations-map-#{rand(1000000)}-#{rand(100000)}" 
	map_scope ||= 'usa'
%>

<div class="row">

	<div id="<%=map_id%>" class="route-map col-md-9" style="padding-left: 0; padding-right: 0;"></div>
	<div class="route-map-annotations"></div>

	<script type="text/javascript">

	var mapID = "<%=map_id%>";
	var mapScope = "<%=map_scope%>";

	var routemap = new Datamap({
		element: document.getElementById( mapID ),
		scope: mapScope,
		projection: 'mercator',
		done: function(datamap) {
			datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {
                alert(geography.properties.name);
            });
		},
		fills: {
			defaultFill: '#2b74a5'
		},
		geographyConfig: {
			highlightOnHover: true,
			popupOnHover: false
		}
	});

	// have to use the Rails raw helper to push raw string to the template
	routemap.arc(
		<%=raw route_paths %>,
		{
			strokeColor: '#ffb900'
		}
	);

	</script>

</div><!-- .row -->